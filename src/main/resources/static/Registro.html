<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Registro - CheckInn</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-cover bg-center min-h-screen flex items-center justify-center"
      style="background-image: url('/images/loginMasOpaco.jpg')">
<main class="bg-white/90 p-12 shadow-xl w-full max-w-4xl">
    <div class="flex items-center justify-end gap-4 mb-8">
        <h1 class="text-5xl font-bold text-orange-500">CheckInn</h1>
        <img src="/images/logo.png" alt="Logo" class="w-24 h-18" />
    </div>
    <form class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div>
            <label for="correo" class="block font-semibold text-lg mb-2">Correo electrónico *</label>
            <input name="correo" id="correo" type="email" autocomplete="new-email"
                   pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}"
                   title="Introduce un correo electrónico válido"
                   class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-400"
                   oninvalid="this.classList.add('border-red-500')"
                   oninput="this.setCustomValidity(''); this.classList.remove('border-red-500')"/>
        </div>
        <div>
            <label for="contraseña" class="block font-semibold text-lg mb-2">Contraseña *</label>
            <input name="contraseña" id="contraseña" type="password" autocomplete="new-password"
                   class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-400"/>
        </div>
        <div>
            <label for="dni" class="block font-semibold text-lg mb-2">DNI *</label>
            <input name="dni" id="dni" type="text" pattern="^\d{8}[A-Za-z]$"
                   title="Debe tener 8 números y una letra al final"
                   class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-400"
                   oninvalid="this.classList.add('border-red-500')"
                   oninput="this.setCustomValidity(''); this.classList.remove('border-red-500')"/>
        </div>
        <div>
            <label for="nombre" class="block font-semibold text-lg mb-2">Nombre *</label>
            <input name="nombre" id="nombre" type="text" pattern="[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+"
                   title="Introduce solo letras"
                   class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-400"
                   oninvalid="this.classList.add('border-red-500')"
                   oninput="this.setCustomValidity(''); this.classList.remove('border-red-500')"/>
        </div>
        <div>
            <label for="apellido1" class="block font-semibold text-lg mb-2">Apellido 1 *</label>
            <input name="apellido1" id="apellido1" type="text" pattern="[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+"
                   title="Introduce solo letras"
                   class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-400"
                   oninvalid="this.classList.add('border-red-500')"
                   oninput="this.setCustomValidity(''); this.classList.remove('border-red-500')"/>
        </div>
        <div>
            <label for="apellido2" class="block font-semibold text-lg mb-2">Apellido 2 *</label>
            <input name="apellido2" id="apellido2" type="text" pattern="[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]+"
                   title="Introduce solo letras"
                   class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-400"
                   oninvalid="this.classList.add('border-red-500')"
                   oninput="this.setCustomValidity(''); this.classList.remove('border-red-500')"/>
        </div>
        <div>
            <label for="fechaNacimiento" class="block font-semibold text-lg mb-2">Fecha de nacimiento *</label>
            <input name="fechaNacimiento" id="fechaNacimiento" type="date" class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-400" />
        </div>
        <div>
            <label for="direccion" class="block font-semibold text-lg mb-2">Dirección *</label>
            <input name="direccion" id="direccion" type="text"
                   class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-400"/>
        </div>
        <div>
            <label for="tarjetaBancaria" class="block font-semibold text-lg mb-2">Tarjeta bancaria *</label>
            <input name="tarjetaBancaria" id="tarjetaBancaria" type="text" pattern="^\d{16}$"
                   title="Debe contener 16 dígitos numéricos"
                   class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-400"
                   oninvalid="this.classList.add('border-red-500')"
                   oninput="this.setCustomValidity(''); this.classList.remove('border-red-500')"/>
        </div>
        <div>
            <label for="telefono" class="block font-semibold text-lg mb-2">Teléfono de contacto</label>
            <input name="telefono" id="telefono" type="tel" pattern="^\d{9}$" title="Debe contener 9 dígitos numéricos"
                   class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-400"
                   oninvalid="this.classList.add('border-red-500')"
                   oninput="this.setCustomValidity(''); this.classList.remove('border-red-500')"/>
        </div>
        <div>
            <label for="genero" class="block font-semibold text-lg mb-2">Género</label>
            <select name="genero" id="genero"
                    class="w-full p-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-orange-400">
                <option value="MASCULINO">Hombre</option>
                <option value="FEMENINO">Mujer</option>
            </select>
        </div>
        <div class="md:col-span-2 flex justify-center">
            <button type="submit"
                    class="bg-orange-500 text-white text-lg px-10 py-3 rounded-lg hover:bg-orange-600 transition-all">
                Registrarse
            </button>
        </div>
    </form>
    <p class="text-center text-sm text-gray-700 mt-6">¿Ya tienes cuenta? <a href="Login.html"
                                                                            class="text-orange-500 hover:underline font-semibold">Inicia
        sesión aquí</a></p>
</main>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="app.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        document.querySelector(".cancelar").addEventListener("click", function () {
            window.location.href = "Index.html";
        });
    });

    document.querySelector("form").addEventListener("submit", async function (event) {
        event.preventDefault();

        const formData = new FormData(event.target);
        const datos = Object.fromEntries(formData.entries());

        const requiredFields = [
            "correo", "contraseña", "dni", "nombre",
            "apellido1", "apellido2", "fechaNacimiento",
            "direccion", "tarjetaBancaria"
        ];

        let valid = true;

        requiredFields.forEach(id => {
            const input = document.getElementById(id);
            if (!input.value.trim()) {
                input.classList.add("border-red-500");
                valid = false;
            } else {
                input.classList.remove("border-red-500");
            }
        });

        if (!valid) {
            alert("Por favor, rellena todos los campos obligatorios.");
            return;
        }

        try {
            const response = await axios.post(`${uri}/usuarios`, datos);

            if (response.status === 201) {
                alert("Alta correcta. Inicie sesión para iniciar la aplicación");
                window.location.href = "Login.html";
            } else if (response.status === 409) {
                alert("Registro fallido campos incorrectos");
            } else {
                alert("Ha habido un error de servidor durante el registro");
            }
        } catch (error) {
            console.error("Error:", error);
            alert("Error al conectar con el servidor.");
        }
    });
</script>
</body>
</html>
